!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.ApiClient=e()}}(function(){return function e(t,o,r){function i(a,s){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){var o=t[a][1][e];return i(o?o:e)},u,u.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t){"use strict";function o(e){for(;e.parentResource;)e.identity="",e=e.parentResource}function r(e,t,o){var r=function i(e){return null==e?i:(e&&!n.isString(e)&&console.error("identity должен быть строкой, а не",e),i.identity=e||"",i)};return $.extend(r,a,{resourceName:e,url:e},o),r.parentResource=t,r.instance=t.instance||t,r}function i(e,t){return this instanceof i?(n.isObject(e)&&(t=e,e=location.origin),null==e&&(e=location.origin),t=t||{},t.url=e,this.notifications=!1,this.hooks={data:{},headers:{}},void $.extend(!0,this,t)):new i(e,t)}var n=e("./utils"),a={resourceName:"resource",url:"",add:function(e,t,o){if(o||(o=t||{},t=this),this[e])throw new TypeError("The resource named "+e+"already exists.");if((o.schemaName||o.collectionName||o.storage)&&(o.collectionName=o.collectionName||e),this[e]=new r(e,t,o),o.collectionName&&!storage[o.collectionName]){var i=storage.schemas[o.schemaName];if(!i)throw new TypeError("Resource::"+e+" You cannot use storage (create collection), without specifying the schema of the data.");storage.createCollection(o.collectionName,i,this[e])}return this[e]},constructUrl:function u(){var e=this.identity?"/"+this.identity:"";return this.parentResource?u.call(this.parentResource,!0)+"/"+this.url+e:this.url},_resourceRequest:function(e,t,o){var r=this.constructUrl(),i=this.notifications;return console.log(this.resourceName+"::"+e+" "+r),this.instance._request(e,r,t.data,t,i,o)}},s=[],c={create:"POST",read:"GET",update:"PUT","delete":"DELETE",patch:"PATCH",post:"POST",get:"GET",save:"PUT"};a.get=function(e,t,r){var i=this,a=this.identity,c="GET";n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},t.data=e;var u={method:c,url:this.constructUrl(),ajaxSettings:t,result:null,meta:null};if("GET"===c){var d=_.find(s,u);if(i.storage&&a&&d&&d.result)return r&&r(d.result,d.meta),void o(i)}var l=$.Deferred();return this._resourceRequest(c,t).done(function(o,a,c){var d,f;e&&e.fields&&(f=n.select(e.fields)),d=i.storage&&!t.doNotStore?f?o.result:storage[i.collectionName].add(o.result||o,f,!0):o.result||o,u.result=d,u.meta=o.meta,s.push(u),r&&r(d,o.meta),l.resolve(d,o.meta,a,c)}).fail(function(e,t,o){l.reject(e,t,o)}),o(i),l},a.read=a.get,a.post=function(e,t,r){var i,a=this,s=this.identity,c="POST";n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},a.storage&&e instanceof storage.Document?(i=e._id.toString(),e=e.$__delta()):a.storage&&storage.ObjectId.isValid(s)?i=s:a.storage&&e._id&&storage.ObjectId.isValid(e._id)&&(i=e._id.toString()),t.data=e;var u=$.Deferred();return this._resourceRequest(c,t).done(function(e,o,n){var s;a.storage&&!t.doNotStore?(s=storage[a.collectionName].findById(i),s?(s.set(e.result),storage[a.collectionName].updateIdLink(s),s.isNew=!1):s=storage[a.collectionName].add(e.result||e,void 0,!0)):s=e.result||e,r&&r(s,e.meta),u.resolve(s,e.meta,o,n)}).fail(function(e,t,o){u.reject(e,t,o)}),o(a),u},a.create=a.post,a.put=function(e,t,r){var i,a=this,s=this.identity,c="PUT";n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},a.storage&&e instanceof storage.Document?(i=e._id.toString(),e=e.$__delta()):a.storage&&storage.ObjectId.isValid(s)?i=s:a.storage&&e._id&&storage.ObjectId.isValid(e._id)&&(i=e._id.toString()),t.data=e;var u=$.Deferred();return this._resourceRequest(c,t).done(function(e,o,n){var s;a.storage&&!t.doNotStore?(s=storage[a.collectionName].findById(i),s?(s.set(e.result),storage[a.collectionName].updateIdLink(s),s.isNew=!1):s=storage[a.collectionName].add(e.result||e,void 0,!0)):s=e.result||e,r&&r(s,e.meta),u.resolve(s,e.meta,o,n)}).fail(function(e,t,o){u.reject(e,t,o)}),o(a),u},a.update=a.put,a.save=a.put,a.patch=function(e,t,r){var i,a=this,s=this.identity,c="PATCH";n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},a.storage&&e instanceof storage.Document?(i=e._id.toString(),e=e.$__delta()):a.storage&&storage.ObjectId.isValid(s)?i=s:a.storage&&e._id&&storage.ObjectId.isValid(e._id)&&(i=e._id.toString()),t.data=e;var u=$.Deferred();return this._resourceRequest(c,t).done(function(e,o,n){var s;a.storage&&!t.doNotStore?(s=storage[a.collectionName].findById(i),s?(s.set(e.result),storage[a.collectionName].updateIdLink(s),s.isNew=!1):s=storage[a.collectionName].add(e.result||e,void 0,!0)):s=e.result||e,r&&r(s,e.meta),u.resolve(s,e.meta,o,n)}).fail(function(e,t,o){u.reject(e,t,o)}),o(a),u},a["delete"]=function(e,t,r){var i=this,a="DELETE";n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},t.data=e;var s=$.Deferred();return this._resourceRequest(a,t).done(function(e,t,o){var i;i=e.result||e,r&&r(i,e.meta),s.resolve(i,e.meta,t,o)}).fail(function(e,t,o){s.reject(e,t,o)}),o(i),s},i.prototype={add:a.add,methodsMap:c,_prepareAjaxSettings:function(e,t,o,r){var i=n.deepMerge(this.hooks,r);return i.type=e,i.url=t,this.token&&r.headers&&null==r.headers.token&&(i.headers.Authorization="token "+this.token),"GET"===e?i.data=n.deepMerge(i.data,o):(o&&o.constructor&&o.constructor.name&&"Document"===o.constructor.name?i.data=n.deepMerge(i.data,o.toObject({depopulate:1})):o&&(i.data=n.deepMerge(i.data,o)),i.data&&"application/json"===i.contentType&&(i.data=JSON.stringify(i.data))),n.isObject(t)&&(console.info("Ах@*ть, нужный код!!!!"),i=t),i},_request:function(e,t,o,r,i,a){if(!n.isString(e))throw new Error("Параметр `method` должен быть строкой, а не ",e);var s=this,c="GET"===e?"load":"POST"===e||"PUT"===e||"PATCH"===e?"save":"delete",u=this._prepareAjaxSettings(e,t,o,r);return i=n.isBoolean(i)?i&&cf.notification:this.notifications&&cf.notification,i&&cf.notification[c].show(),$.ajax(u).fail(function(n,u,d){return console.warn(n,u,d),401===n.status&&s.unauthorizedCallback?(s.unauthorizedCallback(n,e,t,o,r,a),void(i&&cf.notification[c].hide())):void(i&&cf.notification[c].fail())}).done(function(){i&&cf.notification[c].hide()}).done(a)}},i.prototype.get=function(e,t){return console.log("api::get"),n.isFunction(e)&&(t=e,e=void 0),e=e||{},this._request("GET",this.url,void 0,e,!1,t)},i.prototype.read=i.prototype.get,i.version="0.3.0",i.utils=n,t.exports=i},{"./utils":2}],2:[function(e,t){"use strict";function o(e){return e&&"object"==typeof e||!1}var r={},i="[object Boolean]",n="[object String]",a=(Array.prototype,Object.prototype),s=a.toString;r.isString=function(e){return"string"==typeof e||o(e)&&s.call(e)===n||!1},r.isBoolean=function(e){return e===!0||e===!1||o(e)&&s.call(e)===i||!1},r.isObject=function(e){var t=typeof e;return e&&null!==e&&"object"===t||!1},r.isFunction=function(e){return"function"==typeof e||!1},r.deepMerge=function c(e,t){var o=Array.isArray(t),r=o&&[]||{};if(o)e=e||[],r=r.concat(e),t.forEach(function(t,o){"undefined"==typeof r[o]?r[o]=t:"object"==typeof t?r[o]=c(e[o],t):-1===e.indexOf(t)&&r.push(t)});else{if(e&&"object"==typeof e&&Object.keys(e).forEach(function(t){r[t]=e[t]}),null==t)return r;Object.keys(t).forEach(function(o){r[o]="object"==typeof t[o]&&t[o]&&e[o]?c(e[o],t[o]):t[o]})}return r},r.select=function(e){if(e){if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");var t={},o=typeof e;if("string"===o||"object"===o&&"number"==typeof e.length&&!Array.isArray(e)){"string"===o&&(e=e.split(/\s+/));for(var i=0,n=e.length;n>i;++i){var a=e[i];if(a){var s="-"===a[0]?0:1;0===s&&(a=a.substring(1)),t[a]=s}}return t}if(r.isObject(e)&&!Array.isArray(e)){for(var c=Object.keys(e),u=0;u<c.length;++u)t[c[u]]=e[c[u]];return t}throw new TypeError("Invalid select() argument. Must be string or object.")}},t.exports=r},{}]},{},[1])(1)});