!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.ApiClient=t()}}(function(){return function t(e,r,o){function n(a,s){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){var r=e[a][1][t];return n(r?r:t)},u,u.exports,t,e,r,o)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(t,e){"use strict";function r(t,e,r){var n=this,i="DELETE";o.isFunction(t)&&(r=t,t=void 0),o.isFunction(e)&&(r=e,e=void 0),e=e||{},e.data=t;var a=$.Deferred();return this._resourceRequest(i,e).done(function(t,e,o){var n;n=t.result||t,r&&r(n,t.meta),a.resolve(n,t.meta,e,o)}).fail(function(t,e,r){a.reject(t,e,r)}),o.clearIdentity(n),a}var o=t("./utils");e.exports=r},{"./utils":5}],2:[function(t,e){"use strict";function r(t,e,r){var o=function i(t){return null==t?i:(t&&!n.isString(t)&&console.error("identity должен быть строкой, а не",t),i.identity=t||"",i)};return $.extend(o,c,{resourceName:t,url:t},r),o.parentResource=e,o.instance=e.instance||e,o}function o(t,e){return this instanceof o?(n.isObject(t)&&(e=t,t=location.origin),null==t&&(t=location.origin),e=e||{},e.url=t,this.notifications=!1,this.hooks={data:{},headers:{}},void $.extend(!0,this,e)):new o(t,e)}var n=t("./utils"),i=t("./get"),a=t("./post").createPostLikeRequest,s=t("./delete"),c={resourceName:"resource",url:"",add:function(t,e,o){if(o||(o=e||{},e=this),this[t])throw new TypeError("The resource named "+t+"already exists.");if((o.schemaName||o.collectionName||o.storage)&&(o.collectionName=o.collectionName||t),this[t]=new r(t,e,o),o.collectionName&&!storage[o.collectionName]){var n=storage.schemas[o.schemaName];if(!n)throw new TypeError("Resource::"+t+" You cannot use storage (create collection), without specifying the schema of the data.");storage.createCollection(o.collectionName,n,this[t])}return this[t]},constructUrl:function u(){var t=this.identity?"/"+this.identity:"";return this.parentResource?u.call(this.parentResource,!0)+"/"+this.url+t:this.url},_resourceRequest:function(t,e,r){var o=this.constructUrl(),n=this.notifications;return console.log(this.resourceName+"::"+t+" "+o),this.instance._request(t,o,e.data,e,n,r)}};c.get=i,c.read=i,c.post=a("POST"),c.create=c.post,c.put=a("PUT"),c.update=c.put,c.save=c.put,c.patch=a("PATCH"),c["delete"]=s,o.prototype={add:c.add,_methods:{create:"POST",read:"GET",update:"PUT","delete":"DELETE",patch:"PATCH",post:"POST",get:"GET",save:"PUT"},_prepareAjaxSettings:function(t,e,r,o){var i=n.deepMerge(this.hooks,o);return i.type=t,i.url=e,this.token&&o.headers&&null==o.headers.token&&(i.headers.Authorization="token "+this.token),"GET"===t?i.data=n.deepMerge(i.data,r):(r&&r.constructor&&r.constructor.name&&"Document"===r.constructor.name?i.data=n.deepMerge(i.data,r.toObject({depopulate:1})):r&&(i.data=n.deepMerge(i.data,r)),i.data&&"application/json"===i.contentType&&(i.data=JSON.stringify(i.data))),n.isObject(e)&&(console.info("Ах@*ть, нужный код!!!!"),i=e),i},_request:function(t,e,r,o,i,a){if(!n.isString(t))throw new Error("Параметр `method` должен быть строкой, а не ",t);var s=this,c="GET"===t?"load":"POST"===t||"PUT"===t||"PATCH"===t?"save":"delete",u=this._prepareAjaxSettings(t,e,r,o);return i=n.isBoolean(i)?i&&cf.notification:this.notifications&&cf.notification,i&&cf.notification[c].show(),$.ajax(u).fail(function(n,u,l){return console.warn(n,u,l),401===n.status&&s.unauthorizedCallback?(s.unauthorizedCallback(n,t,e,r,o,a),void(i&&cf.notification[c].hide())):void(i&&cf.notification[c].fail())}).done(function(){i&&cf.notification[c].hide()}).done(a)}},o.prototype.get=function(t,e){return console.log("api::get"),n.isFunction(t)&&(e=t,t=void 0),t=t||{},this._request("GET",this.url,void 0,t,!1,e)},o.prototype.read=o.prototype.get,o.version="0.3.0",o.utils=n,e.exports=o},{"./delete":1,"./get":3,"./post":4,"./utils":5}],3:[function(t,e){"use strict";function r(t,e,r){var i=this,a=this.identity,s="GET";o.isFunction(t)&&(r=t,t=void 0),o.isFunction(e)&&(r=e,e=void 0),e=e||{},e.data=t;var c={method:s,url:this.constructUrl(),ajaxSettings:e,result:null,meta:null},u=_.find(n,c);if(i.storage&&a&&u&&u.result)return r&&r(u.result,u.meta),void o.clearIdentity(i);var l=$.Deferred();return this._resourceRequest(s,e).done(function(a,s,u){var f,d;t&&t.fields&&(d=o.select(t.fields)),f=i.storage&&!e.doNotStore?d?a.result:storage[i.collectionName].add(a.result||a,d,!0):a.result||a,c.result=f,c.meta=a.meta,n.push(c),r&&r(f,a.meta),l.resolve(f,a.meta,s,u)}).fail(function(t,e,r){l.reject(t,e,r)}),o.clearIdentity(i),l}var o=t("./utils"),n=[];e.exports=r},{"./utils":5}],4:[function(t,e,r){"use strict";function o(t,e,r,o){var n,a=this,s=this.identity;i.isFunction(e)&&(o=e,e=void 0),i.isFunction(r)&&(o=r,r=void 0),r=r||{},a.storage&&e instanceof storage.Document?(n=e._id.toString(),e=e.$__delta()):a.storage&&storage.ObjectId.isValid(s)?n=s:a.storage&&e._id&&storage.ObjectId.isValid(e._id)&&(n=e._id.toString()),r.data=e;var c=$.Deferred();return this._resourceRequest(t,r).done(function(t,e,i){var s;a.storage&&!r.doNotStore?(s=storage[a.collectionName].findById(n),s?(s.set(t.result),storage[a.collectionName].updateIdLink(s),s.isNew=!1):s=storage[a.collectionName].add(t.result||t,void 0,!0)):s=t.result||t,o&&o(s,t.meta),c.resolve(s,t.meta,e,i)}).fail(function(t,e,r){c.reject(t,e,r)}),i.clearIdentity(a),c}function n(t){return function(){var e=Array.prototype.slice.call(arguments);return o.apply(this,[t].concat(e))}}var i=t("./utils");r.postLikeRequest=o,r.createPostLikeRequest=n},{"./utils":5}],5:[function(t,e){"use strict";function r(t){return t&&"object"==typeof t||!1}var o={},n="[object Boolean]",i="[object String]",a=(Array.prototype,Object.prototype),s=a.toString;o.isString=function(t){return"string"==typeof t||r(t)&&s.call(t)===i||!1},o.isBoolean=function(t){return t===!0||t===!1||r(t)&&s.call(t)===n||!1},o.isObject=function(t){var e=typeof t;return t&&null!==t&&"object"===e||!1},o.isFunction=function(t){return"function"==typeof t||!1},o.deepMerge=function c(t,e){var r=Array.isArray(e),o=r&&[]||{};if(r)t=t||[],o=o.concat(t),e.forEach(function(e,r){"undefined"==typeof o[r]?o[r]=e:"object"==typeof e?o[r]=c(t[r],e):-1===t.indexOf(e)&&o.push(e)});else{if(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),null==e)return o;Object.keys(e).forEach(function(r){o[r]="object"==typeof e[r]&&e[r]&&t[r]?c(t[r],e[r]):e[r]})}return o},o.select=function(t){if(t){if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");var e={},r=typeof t;if("string"===r||"object"===r&&"number"==typeof t.length&&!Array.isArray(t)){"string"===r&&(t=t.split(/\s+/));for(var n=0,i=t.length;i>n;++n){var a=t[n];if(a){var s="-"===a[0]?0:1;0===s&&(a=a.substring(1)),e[a]=s}}return e}if(o.isObject(t)&&!Array.isArray(t)){for(var c=Object.keys(t),u=0;u<c.length;++u)e[c[u]]=t[c[u]];return e}throw new TypeError("Invalid select() argument. Must be string or object.")}},o.clearIdentity=function(t){for(;t.parentResource;)t.identity="",t=t.parentResource},e.exports=o},{}]},{},[2])(2)});