!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.ApiClient=t()}}(function(){return function t(e,o,r){function n(a,s){if(!o[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){var o=e[a][1][t];return n(o?o:t)},u,u.exports,t,e,o,r)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(t,e){"use strict";function o(){this.data={}}var r=t("./utils");o.prototype.getKey=function(t){var e="",o=this;return Object.keys(t).forEach(function(n){var i=t[n];e+=n+"="+(r.isObject(i)?"{"+o.getKey(i)+"}":i)+"|"}),e},o.prototype.put=function(t,e){this.data[t]={created:new Date,data:e}},o.prototype.get=function(t){var e;return(e=this.data[t])?(e.data.response.__cached=!0,e.data):void 0},o.prototype.clear=function(){this.data={}},e.exports=o},{"./utils":6}],2:[function(t,e){"use strict";function o(t,e,o){var n=this,i="DELETE";r.isFunction(t)&&(o=t,t=void 0),r.isFunction(e)&&(o=e,e=void 0),e=e||{},e.data=t;var a=$.Deferred();return this._resourceRequest(i,e).done(function(t,e,r){o&&o(t,e,r),a.resolve(t,e,r)}).fail(function(t,e,o){a.reject(t,e,o)}),r.clearIdentity(n),a}var r=t("./utils");e.exports=o},{"./utils":6}],3:[function(t,e){"use strict";function o(t,e,o){var r=function i(t){return null==t?i:(t&&!n.isString(t)&&console.error("identity должен быть строкой, а не",t),i.identity=t||"",i)};return $.extend(r,u,{resourceName:t,url:t},o),r.parentResource=e,r.apiRoot=e.apiRoot||e,r}function r(t,e){return this instanceof r?(this.defaults={stripTrailingSlashes:!0,cache:!0},n.isObject(t)&&(e=t,t=location.origin),null==t&&(t=location.origin),e=e||{},e.url=t,this.notifications=!1,this.hooks={data:{},headers:{}},$.extend(!0,this,e),void(this.defaults.cache&&(this.cache=new c))):new r(t,e)}var n=t("./utils"),i=t("./get"),a=t("./post").createPostLikeRequest,s=t("./delete"),c=t("./cache"),u={resourceName:"resource",url:"",add:function(t,e,r){if(r||(r=e||{},e=this),this[t])throw new TypeError("The resource named "+t+"already exists.");if((r.schemaName||r.collectionName||r.storage)&&(r.collectionName=r.collectionName||t),this[t]=new o(t,e,r),r.collectionName&&!storage[r.collectionName]){var n=storage.schemas[r.schemaName];if(!n)throw new TypeError("Resource::"+t+" You cannot use storage (create collection), without specifying the schema of the data.");storage.createCollection(r.collectionName,n,this[t])}return this[t]},_resourceRequest:function(t,e,o){var r=n.constructUrl(this),i=this.notifications;return this.apiRoot._request(t,r,e.data,e,i,o)}};u.get=i,u.read=i,u.post=a("POST"),u.create=u.post,u.put=a("PUT"),u.update=u.put,u.save=u.put,u.patch=a("PATCH"),u["delete"]=s,r.prototype={add:u.add,_methods:{create:"POST",read:"GET",update:"PUT","delete":"DELETE",patch:"PATCH",post:"POST",get:"GET",save:"PUT"},_prepareAjaxSettings:function(t,e,o,r){var i=n.deepMerge(this.hooks,r);return i.type=t,this.defaults.stripTrailingSlashes&&(e=e.replace(/\/+$/,"")||"/"),i.url=e,this.token&&r.headers&&null==r.headers.token&&(i.headers.Authorization="token "+this.token),"GET"===t?i.data=n.deepMerge(i.data,o):(o&&o.constructor&&o.constructor.name&&"Document"===o.constructor.name?i.data=n.deepMerge(i.data,o.toObject({depopulate:1})):o&&(i.data=n.deepMerge(i.data,o)),i.data&&"application/json"===i.contentType&&(i.data=JSON.stringify(i.data))),n.isObject(e)&&(console.info("Ах@*ть, нужный код!!!!"),i=e),i},_request:function(t,e,o,r,i,a){if(!n.isString(t))throw new Error("Параметр `method` должен быть строкой, а не ",t);var s=this,c="GET"===t?"load":"POST"===t||"PUT"===t||"PATCH"===t?"save":"delete",u=this._prepareAjaxSettings(t,e,o,r);return i=n.isBoolean(i)?i&&cf.notification:this.notifications&&cf.notification,i&&cf.notification[c].show(),console.log(t+" "+u.url),$.ajax(u).fail(function(n,u,l){return console.warn(n,u,l),401===n.status&&s.unauthorizedCallback?(s.unauthorizedCallback(n,t,e,o,r,a),void(i&&cf.notification[c].hide())):void(i&&cf.notification[c].fail())}).done(function(){i&&cf.notification[c].hide()}).done(a)}},r.prototype.get=function(t,e){return console.log("api::get"),n.isFunction(t)&&(e=t,t=void 0),t=t||{},this._request("GET",this.url,void 0,t,!1,e)},r.prototype.read=r.prototype.get,r.version="0.3.0",r.utils=n,e.exports=r},{"./cache":1,"./delete":2,"./get":4,"./post":5,"./utils":6}],4:[function(t,e){"use strict";function o(t,e,o){var n,i=this,a="GET";if(r.isFunction(t)&&(o=t,t=void 0),r.isFunction(e)&&(o=e,e=void 0),e=e||{},e.data=t,i.apiRoot.defaults.cache){e.url=r.constructUrl(i),n=i.apiRoot.cache.getKey(e);var s=i.apiRoot.cache.get(n);if(s)return o&&o(s.response,s.textStatus,s.jqXHR),r.clearIdentity(i),$.Deferred().resolve(s.response,s.textStatus,s.jqXHR)}var c=$.Deferred();return this._resourceRequest(a,e).done(function(a,s,u){var l;t&&t.fields&&(l=r.select(t.fields)),i.storage&&!e.doNotStore&&(a=storage[i.collectionName].add(a,l,!0)),i.apiRoot.defaults.cache&&i.apiRoot.cache.put(n,{response:a,textStatus:s,jqXHR:u}),o&&o(a,s,u),c.resolve(a,s,u)}).fail(function(t,e,o){c.reject(t,e,o)}),r.clearIdentity(i),c}var r=t("./utils");e.exports=o},{"./utils":6}],5:[function(t,e,o){"use strict";function r(t,e,o,r){var n,a=this,s=this.identity;i.isFunction(e)&&(r=e,e=void 0),i.isFunction(o)&&(r=o,o=void 0),o=o||{},a.storage&&e instanceof storage.Document?(n=e._id.toString(),e=e.$__delta()):a.storage&&storage.ObjectId.isValid(s)?n=s:a.storage&&e._id&&storage.ObjectId.isValid(e._id)&&(n=e._id.toString()),o.data=e;var c=$.Deferred();return this._resourceRequest(t,o).done(function(t,e,i){var s;a.storage&&!o.doNotStore&&(s=storage[a.collectionName].findById(n),s?(s.set(t),storage[a.collectionName].updateIdLink(s),s.isNew=!1,t=s):t=storage[a.collectionName].add(t,void 0,!0)),r&&r(t,e,i),c.resolve(t,e,i)}).fail(function(t,e,o){c.reject(t,e,o)}),i.clearIdentity(a),c}function n(t){return function(){var e=Array.prototype.slice.call(arguments);return r.apply(this,[t].concat(e))}}var i=t("./utils");o.postLikeRequest=r,o.createPostLikeRequest=n},{"./utils":6}],6:[function(t,e){"use strict";function o(t){return t&&"object"==typeof t||!1}var r={},n="[object Boolean]",i="[object String]",a=(Array.prototype,Object.prototype),s=a.toString;r.isString=function(t){return"string"==typeof t||o(t)&&s.call(t)===i||!1},r.isBoolean=function(t){return t===!0||t===!1||o(t)&&s.call(t)===n||!1},r.isObject=function(t){var e=typeof t;return t&&null!==t&&"object"===e||!1},r.isFunction=function(t){return"function"==typeof t||!1},r.deepMerge=function c(t,e){var o=Array.isArray(e),r=o&&[]||{};if(o)t=t||[],r=r.concat(t),e.forEach(function(e,o){"undefined"==typeof r[o]?r[o]=e:"object"==typeof e?r[o]=c(t[o],e):-1===t.indexOf(e)&&r.push(e)});else{if(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){r[e]=t[e]}),null==e)return r;Object.keys(e).forEach(function(o){r[o]="object"==typeof e[o]&&e[o]&&t[o]?c(t[o],e[o]):e[o]})}return r},r.select=function(t){if(t){if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");var e={},o=typeof t;if("string"===o||"object"===o&&"number"==typeof t.length&&!Array.isArray(t)){"string"===o&&(t=t.split(/\s+/));for(var n=0,i=t.length;i>n;++n){var a=t[n];if(a){var s="-"===a[0]?0:1;0===s&&(a=a.substring(1)),e[a]=s}}return e}if(r.isObject(t)&&!Array.isArray(t)){for(var c=Object.keys(t),u=0;u<c.length;++u)e[c[u]]=t[c[u]];return e}throw new TypeError("Invalid select() argument. Must be string or object.")}},r.clearIdentity=function(t){for(;t.parentResource;)t.identity="",t=t.parentResource},r.constructUrl=function u(t){var e=t.identity?"/"+t.identity:"/";return t.parentResource?u(t.parentResource)+"/"+t.url+e:t.url},e.exports=r},{}]},{},[3])(3)});