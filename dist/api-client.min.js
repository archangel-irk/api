!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.ApiClient=t()}}(function(){return function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return o(n?n:t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e){"use strict";function n(){this.data={}}var r=t("./utils");n.prototype.getKey=function(t){var e="",n=this;return Object.keys(t).forEach(function(o){var i=t[o];e+=o+"="+(r.isObject(i)?"{"+n.getKey(i)+"}":i)+"|"}),e},n.prototype.put=function(t,e){this.data[t]={created:new Date,data:e}},n.prototype.get=function(t){var e;return(e=this.data[t])?(e.data.response.__cached=!0,e.data):void 0},n.prototype.clear=function(){this.data={}},e.exports=n},{"./utils":6}],2:[function(t,e){"use strict";function n(t,e,n){var o=this,i="DELETE";r.isFunction(t)&&(n=t,t=void 0),r.isFunction(e)&&(n=e,e=void 0),e=e||{},e.data=t;var a=$.Deferred();return this._resourceRequest(i,e).done(function(t,e,r){n&&n(t,e,r),a.resolve(t,e,r)}).fail(function(t,e,n){a.reject(t,e,n)}),r.clearIdentity(o),a}var r=t("./utils");e.exports=n},{"./utils":6}],3:[function(t,e){"use strict";function n(t,e,n){var r=function i(t){return null==t?i:(t&&!o.isString(t)&&console.error("identity должен быть строкой, а не",t),i.identity=t||"",i)};return $.extend(r,u,{resourceName:t,url:t},n),r.parentResource=e,r.instance=e.instance||e,r}function r(t,e){return this instanceof r?(this.defaults={stripTrailingSlashes:!0,cache:!0},o.isObject(t)&&(e=t,t=location.origin),null==t&&(t=location.origin),e=e||{},e.url=t,this.notifications=!1,this.hooks={data:{},headers:{}},$.extend(!0,this,e),void(this.defaults.cache&&(this.cache=new c))):new r(t,e)}var o=t("./utils"),i=t("./get"),a=t("./post").createPostLikeRequest,s=t("./delete"),c=t("./cache"),u={resourceName:"resource",url:"",add:function(t,e,r){if(r||(r=e||{},e=this),this[t])throw new TypeError("The resource named "+t+"already exists.");if((r.schemaName||r.collectionName||r.storage)&&(r.collectionName=r.collectionName||t),this[t]=new n(t,e,r),r.collectionName&&!storage[r.collectionName]){var o=storage.schemas[r.schemaName];if(!o)throw new TypeError("Resource::"+t+" You cannot use storage (create collection), without specifying the schema of the data.");storage.createCollection(r.collectionName,o,this[t])}return this[t]},_resourceRequest:function(t,e,n){var r=o.constructUrl(this),i=this.notifications;return this.instance._request(t,r,e.data,e,i,n)}};u.get=i,u.read=i,u.post=a("POST"),u.create=u.post,u.put=a("PUT"),u.update=u.put,u.save=u.put,u.patch=a("PATCH"),u["delete"]=s,r.prototype={add:u.add,_methods:{create:"POST",read:"GET",update:"PUT","delete":"DELETE",patch:"PATCH",post:"POST",get:"GET",save:"PUT"},_prepareAjaxSettings:function(t,e,n,r){var i=o.deepMerge(this.hooks,r);return i.type=t,this.defaults.stripTrailingSlashes&&(e=e.replace(/\/+$/,"")||"/"),i.url=e,this.token&&r.headers&&null==r.headers.token&&(i.headers.Authorization="token "+this.token),"GET"===t?i.data=o.deepMerge(i.data,n):(n&&n.constructor&&n.constructor.name&&"Document"===n.constructor.name?i.data=o.deepMerge(i.data,n.toObject({depopulate:1})):n&&(i.data=o.deepMerge(i.data,n)),i.data&&"application/json"===i.contentType&&(i.data=JSON.stringify(i.data))),o.isObject(e)&&(console.info("Ах@*ть, нужный код!!!!"),i=e),i},_request:function(t,e,n,r,i,a){if(!o.isString(t))throw new Error("Параметр `method` должен быть строкой, а не ",t);var s=this,c="GET"===t?"load":"POST"===t||"PUT"===t||"PATCH"===t?"save":"delete",u=this._prepareAjaxSettings(t,e,n,r);return i=o.isBoolean(i)?i&&cf.notification:this.notifications&&cf.notification,i&&cf.notification[c].show(),console.log(t+" "+u.url),$.ajax(u).fail(function(o,u,l){return console.warn(o,u,l),401===o.status&&s.unauthorizedCallback?(s.unauthorizedCallback(o,t,e,n,r,a),void(i&&cf.notification[c].hide())):void(i&&cf.notification[c].fail())}).done(function(){i&&cf.notification[c].hide()}).done(a)}},r.prototype.get=function(t,e){return console.log("api::get"),o.isFunction(t)&&(e=t,t=void 0),t=t||{},this._request("GET",this.url,void 0,t,!1,e)},r.prototype.read=r.prototype.get,r.version="0.3.0",r.utils=o,e.exports=r},{"./cache":1,"./delete":2,"./get":4,"./post":5,"./utils":6}],4:[function(t,e){"use strict";function n(t,e,n){var o,i=this,a="GET";if(r.isFunction(t)&&(n=t,t=void 0),r.isFunction(e)&&(n=e,e=void 0),e=e||{},e.data=t,i.instance.defaults.cache){e.url=r.constructUrl(i),o=i.instance.cache.getKey(e);var s=i.instance.cache.get(o);if(s)return n&&n(s.response,s.textStatus,s.jqXHR),r.clearIdentity(i),$.Deferred().resolve(s.response,s.textStatus,s.jqXHR)}var c=$.Deferred();return this._resourceRequest(a,e).done(function(a,s,u){var l;t&&t.fields&&(l=r.select(t.fields)),i.storage&&!e.doNotStore&&(a=storage[i.collectionName].add(a,l,!0)),i.instance.defaults.cache&&i.instance.cache.put(o,{response:a,textStatus:s,jqXHR:u}),n&&n(a,s,u),c.resolve(a,s,u)}).fail(function(t,e,n){c.reject(t,e,n)}),r.clearIdentity(i),c}var r=t("./utils");e.exports=n},{"./utils":6}],5:[function(t,e,n){"use strict";function r(t,e,n,r){var o,a=this,s=this.identity;i.isFunction(e)&&(r=e,e=void 0),i.isFunction(n)&&(r=n,n=void 0),n=n||{},a.storage&&e instanceof storage.Document?(o=e._id.toString(),e=e.$__delta()):a.storage&&storage.ObjectId.isValid(s)?o=s:a.storage&&e._id&&storage.ObjectId.isValid(e._id)&&(o=e._id.toString()),n.data=e;var c=$.Deferred();return this._resourceRequest(t,n).done(function(t,e,i){var s;a.storage&&!n.doNotStore&&(s=storage[a.collectionName].findById(o),s?(s.set(t),storage[a.collectionName].updateIdLink(s),s.isNew=!1,t=s):t=storage[a.collectionName].add(t,void 0,!0)),r&&r(t,e,i),c.resolve(t,e,i)}).fail(function(t,e,n){c.reject(t,e,n)}),i.clearIdentity(a),c}function o(t){return function(){var e=Array.prototype.slice.call(arguments);return r.apply(this,[t].concat(e))}}var i=t("./utils");n.postLikeRequest=r,n.createPostLikeRequest=o},{"./utils":6}],6:[function(t,e){"use strict";function n(t){return t&&"object"==typeof t||!1}var r={},o="[object Boolean]",i="[object String]",a=(Array.prototype,Object.prototype),s=a.toString;r.isString=function(t){return"string"==typeof t||n(t)&&s.call(t)===i||!1},r.isBoolean=function(t){return t===!0||t===!1||n(t)&&s.call(t)===o||!1},r.isObject=function(t){var e=typeof t;return t&&null!==t&&"object"===e||!1},r.isFunction=function(t){return"function"==typeof t||!1},r.deepMerge=function c(t,e){var n=Array.isArray(e),r=n&&[]||{};if(n)t=t||[],r=r.concat(t),e.forEach(function(e,n){"undefined"==typeof r[n]?r[n]=e:"object"==typeof e?r[n]=c(t[n],e):-1===t.indexOf(e)&&r.push(e)});else{if(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){r[e]=t[e]}),null==e)return r;Object.keys(e).forEach(function(n){r[n]="object"==typeof e[n]&&e[n]&&t[n]?c(t[n],e[n]):e[n]})}return r},r.select=function(t){if(t){if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");var e={},n=typeof t;if("string"===n||"object"===n&&"number"==typeof t.length&&!Array.isArray(t)){"string"===n&&(t=t.split(/\s+/));for(var o=0,i=t.length;i>o;++o){var a=t[o];if(a){var s="-"===a[0]?0:1;0===s&&(a=a.substring(1)),e[a]=s}}return e}if(r.isObject(t)&&!Array.isArray(t)){for(var c=Object.keys(t),u=0;u<c.length;++u)e[c[u]]=t[c[u]];return e}throw new TypeError("Invalid select() argument. Must be string or object.")}},r.clearIdentity=function(t){for(;t.parentResource;)t.identity="",t=t.parentResource},r.constructUrl=function u(t){var e=t.identity?"/"+t.identity:"/";return t.parentResource?u(t.parentResource)+"/"+t.url+e:t.url},e.exports=r},{}]},{},[3])(3)});