!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.ApiClient=e()}}(function(){return function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return o(r?r:e)},u,u.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t){"use strict";function r(){this.data={}}var n=e("./utils");r.prototype.getKey=function(e){var t="",r=this;return Object.keys(e).forEach(function(o){var i=e[o];t+=o+"="+(n.isObject(i)?"{"+r.getKey(i)+"}":i)+"|"}),t},r.prototype.put=function(e,t){this.data[e]={created:new Date,data:t}},r.prototype.get=function(e){var t;return(t=this.data[e])?(t.data.response.__cached=!0,t.data):void 0},r.prototype.clear=function(){this.data={}},t.exports=r},{"./utils":6}],2:[function(e,t){"use strict";function r(e,t,r){var o=this,i="DELETE";n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},t.data=e;var a=$.Deferred();return this._resourceRequest(i,t).done(function(e,t,n){var o;o=e.result||e,r&&r(o,e.meta),a.resolve(o,e.meta,t,n)}).fail(function(e,t,r){a.reject(e,t,r)}),n.clearIdentity(o),a}var n=e("./utils");t.exports=r},{"./utils":6}],3:[function(e,t){"use strict";function r(e,t,r){var n=function i(e){return null==e?i:(e&&!o.isString(e)&&console.error("identity должен быть строкой, а не",e),i.identity=e||"",i)};return $.extend(n,u,{resourceName:e,url:e},r),n.parentResource=t,n.instance=t.instance||t,n}function n(e,t){return this instanceof n?(this.defaults={stripTrailingSlashes:!0,cache:!0},o.isObject(e)&&(t=e,e=location.origin),null==e&&(e=location.origin),t=t||{},t.url=e,this.notifications=!1,this.hooks={data:{},headers:{}},$.extend(!0,this,t),void(this.defaults.cache&&(this.cache=new c))):new n(e,t)}var o=e("./utils"),i=e("./get"),a=e("./post").createPostLikeRequest,s=e("./delete"),c=e("./cache"),u={resourceName:"resource",url:"",add:function(e,t,n){if(n||(n=t||{},t=this),this[e])throw new TypeError("The resource named "+e+"already exists.");if((n.schemaName||n.collectionName||n.storage)&&(n.collectionName=n.collectionName||e),this[e]=new r(e,t,n),n.collectionName&&!storage[n.collectionName]){var o=storage.schemas[n.schemaName];if(!o)throw new TypeError("Resource::"+e+" You cannot use storage (create collection), without specifying the schema of the data.");storage.createCollection(n.collectionName,o,this[e])}return this[e]},_resourceRequest:function(e,t,r){var n=o.constructUrl(this),i=this.notifications;return this.instance._request(e,n,t.data,t,i,r)}};u.get=i,u.read=i,u.post=a("POST"),u.create=u.post,u.put=a("PUT"),u.update=u.put,u.save=u.put,u.patch=a("PATCH"),u["delete"]=s,n.prototype={add:u.add,_methods:{create:"POST",read:"GET",update:"PUT","delete":"DELETE",patch:"PATCH",post:"POST",get:"GET",save:"PUT"},_prepareAjaxSettings:function(e,t,r,n){var i=o.deepMerge(this.hooks,n);return i.type=e,this.defaults.stripTrailingSlashes&&(t=t.replace(/\/+$/,"")||"/"),i.url=t,this.token&&n.headers&&null==n.headers.token&&(i.headers.Authorization="token "+this.token),"GET"===e?i.data=o.deepMerge(i.data,r):(r&&r.constructor&&r.constructor.name&&"Document"===r.constructor.name?i.data=o.deepMerge(i.data,r.toObject({depopulate:1})):r&&(i.data=o.deepMerge(i.data,r)),i.data&&"application/json"===i.contentType&&(i.data=JSON.stringify(i.data))),o.isObject(t)&&(console.info("Ах@*ть, нужный код!!!!"),i=t),i},_request:function(e,t,r,n,i,a){if(!o.isString(e))throw new Error("Параметр `method` должен быть строкой, а не ",e);var s=this,c="GET"===e?"load":"POST"===e||"PUT"===e||"PATCH"===e?"save":"delete",u=this._prepareAjaxSettings(e,t,r,n);return i=o.isBoolean(i)?i&&cf.notification:this.notifications&&cf.notification,i&&cf.notification[c].show(),console.log(e+" "+u.url),$.ajax(u).fail(function(o,u,l){return console.warn(o,u,l),401===o.status&&s.unauthorizedCallback?(s.unauthorizedCallback(o,e,t,r,n,a),void(i&&cf.notification[c].hide())):void(i&&cf.notification[c].fail())}).done(function(){i&&cf.notification[c].hide()}).done(a)}},n.prototype.get=function(e,t){return console.log("api::get"),o.isFunction(e)&&(t=e,e=void 0),e=e||{},this._request("GET",this.url,void 0,e,!1,t)},n.prototype.read=n.prototype.get,n.version="0.3.0",n.utils=o,t.exports=n},{"./cache":1,"./delete":2,"./get":4,"./post":5,"./utils":6}],4:[function(e,t){"use strict";function r(e,t,r){var o,i=this,a="GET";if(n.isFunction(e)&&(r=e,e=void 0),n.isFunction(t)&&(r=t,t=void 0),t=t||{},t.data=e,i.instance.defaults.cache){t.url=n.constructUrl(i),o=i.instance.cache.getKey(t);var s=i.instance.cache.get(o);if(s)return r&&r(s.response,s.textStatus,s.jqXHR),n.clearIdentity(i),$.Deferred().resolve(s.response,s.textStatus,s.jqXHR)}var c=$.Deferred();return this._resourceRequest(a,t).done(function(a,s,u){var l;e&&e.fields&&(l=n.select(e.fields)),i.storage&&!t.doNotStore&&(a.result?a.result=storage[i.collectionName].add(a.result||a,l,!0):a=storage[i.collectionName].add(a.result||a,l,!0)),i.instance.defaults.cache&&i.instance.cache.put(o,{response:a,textStatus:s,jqXHR:u}),r&&r(a,s,u),c.resolve(a,s,u)}).fail(function(e,t,r){c.reject(e,t,r)}),n.clearIdentity(i),c}var n=e("./utils");t.exports=r},{"./utils":6}],5:[function(e,t,r){"use strict";function n(e,t,r,n){var o,a=this,s=this.identity;i.isFunction(t)&&(n=t,t=void 0),i.isFunction(r)&&(n=r,r=void 0),r=r||{},a.storage&&t instanceof storage.Document?(o=t._id.toString(),t=t.$__delta()):a.storage&&storage.ObjectId.isValid(s)?o=s:a.storage&&t._id&&storage.ObjectId.isValid(t._id)&&(o=t._id.toString()),r.data=t;var c=$.Deferred();return this._resourceRequest(e,r).done(function(e,t,i){var s;a.storage&&!r.doNotStore?(s=storage[a.collectionName].findById(o),s?(s.set(e.result),storage[a.collectionName].updateIdLink(s),s.isNew=!1):s=storage[a.collectionName].add(e.result||e,void 0,!0)):s=e.result||e,n&&n(s,e.meta),c.resolve(s,e.meta,t,i)}).fail(function(e,t,r){c.reject(e,t,r)}),i.clearIdentity(a),c}function o(e){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(this,[e].concat(t))}}var i=e("./utils");r.postLikeRequest=n,r.createPostLikeRequest=o},{"./utils":6}],6:[function(e,t){"use strict";function r(e){return e&&"object"==typeof e||!1}var n={},o="[object Boolean]",i="[object String]",a=(Array.prototype,Object.prototype),s=a.toString;n.isString=function(e){return"string"==typeof e||r(e)&&s.call(e)===i||!1},n.isBoolean=function(e){return e===!0||e===!1||r(e)&&s.call(e)===o||!1},n.isObject=function(e){var t=typeof e;return e&&null!==e&&"object"===t||!1},n.isFunction=function(e){return"function"==typeof e||!1},n.deepMerge=function c(e,t){var r=Array.isArray(t),n=r&&[]||{};if(r)e=e||[],n=n.concat(e),t.forEach(function(t,r){"undefined"==typeof n[r]?n[r]=t:"object"==typeof t?n[r]=c(e[r],t):-1===e.indexOf(t)&&n.push(t)});else{if(e&&"object"==typeof e&&Object.keys(e).forEach(function(t){n[t]=e[t]}),null==t)return n;Object.keys(t).forEach(function(r){n[r]="object"==typeof t[r]&&t[r]&&e[r]?c(e[r],t[r]):t[r]})}return n},n.select=function(e){if(e){if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");var t={},r=typeof e;if("string"===r||"object"===r&&"number"==typeof e.length&&!Array.isArray(e)){"string"===r&&(e=e.split(/\s+/));for(var o=0,i=e.length;i>o;++o){var a=e[o];if(a){var s="-"===a[0]?0:1;0===s&&(a=a.substring(1)),t[a]=s}}return t}if(n.isObject(e)&&!Array.isArray(e)){for(var c=Object.keys(e),u=0;u<c.length;++u)t[c[u]]=e[c[u]];return t}throw new TypeError("Invalid select() argument. Must be string or object.")}},n.clearIdentity=function(e){for(;e.parentResource;)e.identity="",e=e.parentResource},n.constructUrl=function u(e){var t=e.identity?"/"+e.identity:"/";return e.parentResource?u(e.parentResource)+"/"+e.url+t:e.url},t.exports=n},{}]},{},[3])(3)});